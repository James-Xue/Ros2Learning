# ğŸŒ³ ROS 2 BehaviorTree.CPP Learning Package

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªç”¨äºå­¦ä¹ å’Œæ¼”ç¤º **BehaviorTree.CPP (v4)** ä¸ **ROS 2** é›†æˆçš„ç¤ºä¾‹åŒ…ã€‚

## ğŸ“‹ è¿è¡Œä¾èµ– (é‡è¦)

æœ¬é¡¹ç›®è®¾è®¡äº†ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼Œè¯·æ ¹æ®æ‚¨çš„ç¯å¢ƒé€‰æ‹©ï¼š

1.  **Mock (æ¨¡æ‹Ÿ) æ¨¡å¼ [æ¨èå…¥é—¨]**:
    *   **æ— éœ€ç‹¬ç«‹å®‰è£… Nav2**ã€‚
    *   ä½¿ç”¨æ‰“æ¡©è¿‡çš„ C++ èŠ‚ç‚¹æ¨¡æ‹Ÿç§»åŠ¨å’Œæ¢å¤é€»è¾‘ã€‚
    *   **é€‚ç”¨åœºæ™¯**ï¼šçº¯é€»è¾‘éªŒè¯ã€å­¦ä¹ é»‘æ¿æ•°æ®æµã€å­¦ä¹ å®¹é”™æœºåˆ¶ã€‚
2.  **Real (çœŸå®) æ¨¡å¼**:
    *   **éœ€è¦å®‰è£…å¹¶å¯åŠ¨ Nav2**ï¼ˆæä¾› `/navigate_to_pose` åŠ¨ä½œæœåŠ¡å™¨ï¼‰ã€‚
    *   **é€‚ç”¨åœºæ™¯**ï¼šçœŸå®æœºå™¨äººæˆ– Gazebo ä»¿çœŸç¯å¢ƒã€‚

---

## ğŸ› ï¸ ç¼–è¯‘ä¸å®‰è£…

```bash
cd ~/ros2_ws
colcon build --packages-select ros2_learning_behavior_tree
source install/setup.bash
```

---

## ğŸš€ å¯åŠ¨æ¼”ç¤º (Mock é€»è¾‘éªŒè¯)

å¦‚æœæ‚¨æ²¡æœ‰è¿è¡Œ Nav2ï¼Œè¯·åŠ¡å¿…å¯åŠ¨å¸¦ `mock` å­—æ ·çš„è¡Œä¸ºæ ‘ï¼Œå¦åˆ™ç¨‹åºä¼šå› æ‰¾ä¸åˆ° Action Server è€Œé€€å‡ºã€‚

### 1. å®¹é”™é€»è¾‘æ¼”ç¤º (Fallback)
æ¼”ç¤ºä¸€ä¸ªä½æˆåŠŸç‡çš„ä»»åŠ¡ï¼Œå¤±è´¥åæ‰§è¡Œæ¢å¤åŠ¨ä½œå¹¶é‡è¯•ã€‚
```bash
ros2 launch ros2_learning_behavior_tree bt_demo.launch.py tree_file:=mock_fallback_demo.xml
```

### 2. æ•°æ®æµæ¼”ç¤º (Blackboard)
æ¼”ç¤ºå¦‚ä½•ä»é˜Ÿåˆ—å–ç‚¹ï¼Œé€šè¿‡é»‘æ¿ä¼ é€’ç»™ç§»åŠ¨èŠ‚ç‚¹ã€‚
```bash
ros2 launch ros2_learning_behavior_tree bt_demo.launch.py tree_file:=mock_blackboard_demo.xml
```

### 3. æ¨¡å—åŒ–å­æ ‘æ¼”ç¤º (SubTree)
æ¼”ç¤ºä¸»æ ‘å¦‚ä½•åŠ è½½å¹¶è°ƒç”¨å¤–éƒ¨å®šä¹‰çš„å­æ ‘æ–‡ä»¶ã€‚
```bash
ros2 launch ros2_learning_behavior_tree bt_demo.launch.py tree_file:=main_tree_composition.xml
```

---

## ğŸ›°ï¸ å¯åŠ¨æ¼”ç¤º (çœŸå® Nav2 ç¯å¢ƒ)

**æ³¨æ„**ï¼šè¿è¡Œä»¥ä¸‹å‘½ä»¤å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æœºå™¨äººä»¿çœŸç¯å¢ƒå·²å¯åŠ¨ï¼Œä¸” Nav2 èŠ‚ç‚¹æ­£å¸¸å·¥ä½œã€‚

```bash
ros2 launch ros2_learning_behavior_tree bt_demo.launch.py tree_file:=simple_patrol.xml
```

---

## ğŸ“‚ èŠ‚ç‚¹ä¸æ–‡ä»¶ç»“æ„

æœ¬é¡¹ç›®é€šè¿‡å°†èŠ‚ç‚¹æ‹†åˆ†ä¸º `.hpp` å’Œ `.cpp` å¹¶åœ¨ `bt_main.cpp` ä¸­ç»Ÿä¸€æ³¨å†Œï¼Œå±•ç¤ºäº†æ ‡å‡†çš„å·¥ç¨‹åŒ–å†™æ³•ã€‚

| ç±»åˆ« | èŠ‚ç‚¹å | è¯´æ˜ |
| :--- | :--- | :--- |
| **æ¨¡æ‹Ÿ** | `MockMoveBase` | æ¨¡æ‹Ÿç§»åŠ¨ï¼Œå¯é…ç½®è€—æ—¶ä¸æˆåŠŸç‡ã€‚ |
| **æ¨¡æ‹Ÿ** | `MockRecovery` | æ¨¡æ‹Ÿæ¢å¤è¡Œä¸ºï¼ˆå¦‚ Spinï¼‰ã€‚ |
| **æ¨¡æ‹Ÿ** | `GetLocationFromQueue` | æ•°æ®ç”Ÿäº§è€…ï¼Œç”¨äºæ¼”ç¤ºé»‘æ¿è¯»å†™ã€‚ |
| **çœŸå®** | `MoveBase` | **Nav2 å®¢æˆ·ç«¯**ï¼Œè¿æ¥çœŸå®å¯¼èˆªæœåŠ¡å™¨ã€‚ |

---

## ğŸ” å¯è§†åŒ–è°ƒè¯• (Groot2)

æœ¬åŒ…å·²é›†æˆ Groot2 å‘å¸ƒå™¨ã€‚å¯åŠ¨ä»»æ„è¡Œä¸ºæ ‘åï¼Œå¯ä»¥ä½¿ç”¨ Groot2 è¿›è¡Œå®æ—¶ç›‘æ§ï¼š
1. ä¸‹è½½å¹¶æ‰“å¼€ [Groot2](https://www.behaviortree.dev/groot)ã€‚
2. ç‚¹å‡» **Connect** -> **Standard Mode**ã€‚
3. è¾“å…¥ `localhost`ï¼Œç‚¹å‡»è¿æ¥å³å¯çœ‹åˆ°å½“å‰æ ‘çš„å®æ—¶çŠ¶æ€ï¼ˆå˜ç»¿è‰²ä»£è¡¨è¿è¡Œä¸­ï¼‰ã€‚

---

## ğŸ“ è¯¦ç»†æ•™ç¨‹
æ›´å¤šæ¦‚å¿µè§£é‡Šè¯·å‚è€ƒï¼š[docs/bt_learning_roadmap.md](docs/bt_learning_roadmap.md)
